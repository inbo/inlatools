<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Setting a prior for the random intercept variance and fixed effects • inlatools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Setting a prior for the random intercept variance and fixed effects">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">inlatools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/distribution.html">Checking the distribution and dispersion of a model</a>
    </li>
    <li>
      <a href="../articles/prior.html">Setting a prior for the random intercept variance and fixed effects</a>
    </li>
    <li>
      <a href="../articles/rwprior.html">Getting a grasp on the random walk hyperparameter</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/inbo/inlatools">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Setting a prior for the random intercept variance and fixed effects</h1>
                        <h4 class="author">Thierry Onkelinx</h4>
            
            <h4 class="date">2019-01-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/inbo/inlatools/blob/master/vignettes/prior.Rmd"><code>vignettes/prior.Rmd</code></a></small>
      <div class="hidden name"><code>prior.Rmd</code></div>

    </div>

    
    
<div id="simulating-random-intercepts" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-random-intercepts" class="anchor"></a>Simulating random intercepts</h2>
<p><code><a href="../reference/simulate_iid.html">simulate_iid()</a></code> generates a number of iid random intercepts from a zero mean Gaussian distribution with variance <span class="math inline">\(\sigma^2\)</span>. The variance is either specified through the standard deviance <span class="math inline">\(\sigma\)</span> or the precision <span class="math inline">\(\tau = 1 /\sigma ^2\)</span>. Specifying both leads to an error, even if both arguments have compatible arguments.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(inlatools)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(x &lt;-<span class="st"> </span><span class="kw"><a href="../reference/simulate_iid.html">simulate_iid</a></span>(<span class="dt">sigma =</span> <span class="dv">1</span>))
<span class="co">#&gt;  'sim_iid' num [1:1000] 0.228 -0.491 -0.998 -0.641 -0.87 ...</span>
<span class="co">#&gt;  - attr(*, "sigma")= num 1</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(y &lt;-<span class="st"> </span><span class="kw"><a href="../reference/simulate_iid.html">simulate_iid</a></span>(<span class="dt">tau =</span> <span class="dv">100</span>))
<span class="co">#&gt;  'sim_iid' num [1:1000] 9.05e-06 -6.23e-02 2.33e-02 -6.30e-02 1.31e-02 ...</span>
<span class="co">#&gt;  - attr(*, "sigma")= num 0.1</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/simulate_iid.html">simulate_iid</a></span>(<span class="dt">sigma =</span> <span class="fl">0.1</span>, <span class="dt">tau =</span> <span class="dv">100</span>)
<span class="co">#&gt; Error: either 'sigma' or 'tau' must be NULL</span></code></pre></div>
</div>
<div id="inspecting-simulated-random-intercepts" class="section level2">
<h2 class="hasAnchor">
<a href="#inspecting-simulated-random-intercepts" class="anchor"></a>Inspecting simulated random intercepts</h2>
<p>The default <code><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot()</a></code> on the simulated random intercepts yields a density with indication of the baseline and quantiles. The plot title displays the standard deviation, variance and precision used to simulate the random intercepts. This makes it easy to simulate the random intercept based on a standard deviation and get the precision required for the prior.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(x)</code></pre></div>
<div class="figure">
<img src="prior_files/figure-html/iid-default-1.png" alt="Default plot of simulated random intercepts." width="576"><p class="caption">
Default plot of simulated random intercepts.
</p>
</div>
</div>
<div id="link-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#link-functions" class="anchor"></a>Link functions</h2>
<p>Often we are using distributions were the relationship between the mean and the linear predictor is defined through a link function. Therefore we added a <code>link</code> argument to the plot function. This will apply the back transformation to the random intercepts, making it easier to interprete their effect on the original scale.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(x, <span class="dt">link =</span> <span class="st">"log"</span>)</code></pre></div>
<div class="figure">
<img src="prior_files/figure-html/iid-log-1.png" alt="Default plot with log-link" width="576"><p class="caption">
Default plot with log-link
</p>
</div>
<p>The plot shows the effect of the random intercept + the baseline. The default baseline are chosen to get an informative plot. <code>link = "identity</code> uses <code>baseline = 0</code> as default. <code>link = "log"</code> uses <code>baseline = 1</code>, so that the random intercepts can be interpreted as relative effects. In case of <code>link = "logit"</code>, the absolute effect on the natural scale, depends on the baseline. Therefore we use <code>baseline = seq(0, 0.5, length = 21)</code> as default. When more than one baseline is defined, a line plot is used instead of a density. Each random intercept is depicted as a separate line.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(x, <span class="dt">link =</span> <span class="st">"logit"</span>)</code></pre></div>
<div class="figure">
<img src="prior_files/figure-html/iid-logit-1.png" alt="Default plot with logit link" width="576"><p class="caption">
Default plot with logit link
</p>
</div>
<p>The user can override the default baseline. So if you want a density plot in combination with <code>link = "logit"</code>, then you need to specify a single baseline. Note that the baseline is always expressed on the natural scale.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(x, <span class="dt">link =</span> <span class="st">"logit"</span>, <span class="dt">baseline =</span> <span class="fl">0.7</span>)</code></pre></div>
<div class="figure">
<img src="prior_files/figure-html/iid-logit-density-1.png" alt="Density plot with logit link" width="576"><p class="caption">
Density plot with logit link
</p>
</div>
<p>Likewise you can get a line plot for <code>link = "identity"</code> or <code>link = "log"</code> if you specify a vector of baselines. The result of <code><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot()</a></code> is a <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> object, so you can alter it using standard ggplot functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(x, <span class="dt">link =</span> <span class="st">"log"</span>, <span class="dt">baseline =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span>(<span class="st">"baseline"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_log10</a></span>(<span class="st">"effect"</span>)
<span class="co">#&gt; Scale for 'x' is already present. Adding another scale for 'x', which</span>
<span class="co">#&gt; will replace the existing scale.</span>
<span class="co">#&gt; Scale for 'y' is already present. Adding another scale for 'y', which</span>
<span class="co">#&gt; will replace the existing scale.</span></code></pre></div>
<div class="figure">
<img src="prior_files/figure-html/iid-log-line-1.png" alt="Line plot with log link" width="576"><p class="caption">
Line plot with log link
</p>
</div>
</div>
<div id="centering-and-quantiles" class="section level2">
<h2 class="hasAnchor">
<a href="#centering-and-quantiles" class="anchor"></a>Centering and quantiles</h2>
<p>By default the random intercepts are center so that their mean matches the baseline. The alternative are <code>center = "bottom"</code> and <code>center = "top"</code>. In those cases, the random effects are centered to that the baseline matches the lowest (<code>center = "bottom"</code>) or the highest (<code>center = "top"</code>) quantile. This is useful in case you want to get an idea of the difference between the lowest quantile and some other point (e.g. the largest quantile). The plot below illustrates that ratio of more that 50 between extreme random intercepts are not uncommon when <span class="math inline">\(\sigma = 1\)</span> with a log link.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(x, <span class="dt">link =</span> <span class="st">"log"</span>, <span class="dt">center =</span> <span class="st">"bottom"</span>)</code></pre></div>
<div class="figure">
<img src="prior_files/figure-html/iid-bottom-1.png" alt="Density of the random effects after centering to the lowest quantile." width="576"><p class="caption">
Density of the random effects after centering to the lowest quantile.
</p>
</div>
<p>The user has the option to specify custom quantiles.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(
  y, <span class="dt">center =</span> <span class="st">"top"</span>, <span class="dt">link =</span> <span class="st">"logit"</span>, <span class="dt">baseline =</span> <span class="fl">0.9</span>, <span class="dt">quantiles =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>)
)</code></pre></div>
<div class="figure">
<img src="prior_files/figure-html/iid-top-1.png" alt="Density of the random effects after centering to the highest quantile." width="576"><p class="caption">
Density of the random effects after centering to the highest quantile.
</p>
</div>
</div>
<div id="priors-for-fixed-effects" class="section level2">
<h2 class="hasAnchor">
<a href="#priors-for-fixed-effects" class="anchor"></a>Priors for fixed effects</h2>
<p>INLA assumes Gaussian priors for the fixed effects. Hence we can use <code><a href="../reference/simulate_iid.html">simulate_iid()</a></code> to get a feeling of these priors too. Below we give two examples. The first shows the default prior for fixed effects. The second one shows an informative prior for a fixed effect.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed &lt;-<span class="st"> </span><span class="kw"><a href="../reference/simulate_iid.html">simulate_iid</a></span>(<span class="dt">tau =</span> <span class="fl">0.001</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(fixed)</code></pre></div>
<div class="figure">
<img src="prior_files/figure-html/fixed-default-1.png" alt="Simulated density of the default fixed effect prior with mean = 0 and precision = 0.001" width="576"><p class="caption">
Simulated density of the default fixed effect prior with mean = 0 and precision = 0.001
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed &lt;-<span class="st"> </span><span class="kw"><a href="../reference/simulate_iid.html">simulate_iid</a></span>(<span class="dt">tau =</span> <span class="fl">0.1</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(fixed, <span class="dt">baseline =</span> <span class="dv">14</span>)</code></pre></div>
<div class="figure">
<img src="prior_files/figure-html/fixed-informative-1.png" alt="Simulated density of an informative fixed effect prior with mean = 14 and precision = 0.1" width="576"><p class="caption">
Simulated density of an informative fixed effect prior with mean = 14 and precision = 0.1
</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#simulating-random-intercepts">Simulating random intercepts</a></li>
      <li><a href="#inspecting-simulated-random-intercepts">Inspecting simulated random intercepts</a></li>
      <li><a href="#link-functions">Link functions</a></li>
      <li><a href="#centering-and-quantiles">Centering and quantiles</a></li>
      <li><a href="#priors-for-fixed-effects">Priors for fixed effects</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://www.muscardinus.be">Thierry Onkelinx</a>, <a href="https://www.inbo.be/en"><img src="https://inlatools.netlify.com/reference/figures/logo_en.png" height="24" alt="Research Institute for Nature and Forest"></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
